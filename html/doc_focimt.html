
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>focimt</title><meta name="generator" content="MATLAB 8.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-11-10"><meta name="DC.source" content="doc_focimt.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>focimt</h1><!--introduction--><p>Perform seismic moment tensor inversion in time domain.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#6">Additional information</a></li><li><a href="#7">Parameters</a></li><li><a href="#71">Examples</a></li><li><a href="#92">See also</a></li></ul></div><h2>Syntax<a name="1"></a></h2><pre class="language-matlab">focimt(Input)
focimt(Input,<span class="string">'PropertyName'</span>,PropertyValue, <span class="keyword">...</span><span class="comment">)</span>
[Solution, Input] = focimt(<span class="keyword">...</span><span class="comment">)</span>
</pre><h2>Description<a name="2"></a></h2><p>Use <tt>focimt</tt> to perform the seismic moment tensor inversion using fociMT application via MATLAB interface. The function wraps the input and output of data for fociMT executable and provide a convenient interface between MATLAB and fociMT application.</p><p><tt>focimt(Input)</tt> reads input data and performs moment tensor inversion using fociMT software and default processing parameters. The input array can be either a path to the formatted ASCII input file or Input cell array.</p><p><tt>focimt(Input,'PropertyName',PropertyValue, ...)</tt> allows to specify additional parameters in a form of PropertyName-PropertyValue pairs.</p><p><tt>[Solution, Input] = focimt(...)</tt> returns final moment tensor solutions in a form of cell array <tt>Solution</tt> as well as input cell array <tt>Input</tt>.</p><h2>Additional information<a name="6"></a></h2><p>For an up-to-date information on software package, see the following website: <a href="http://www.induced.pl/focimt">http://www.induced.pl/focimt</a>.</p><h2>Parameters<a name="7"></a></h2><p><b>Jacknife</b> - Single station rejection test</p><p><tt>'off'</tt> (default) | <tt>'on'</tt></p><p>Performs station rejection test. Firstly, the seismic moment tensor inversion is performed using all available stations. Then, the inversion is performed <i>n</i> times, where <i>n</i> is the number of stations, and each time different station is removed before inversion is performed. See <i>Examples</i> section for details.</p><p><b>Hemisphere</b> - Hemisphere projection</p><p><tt>'lower'</tt> (default) | <tt>'upper'</tt></p><p>Allows to specify whether the obtained fault plane solution is projected onto <tt>'lower'</tt> or <tt>'upper'</tt> part of the hemisphere in graphical representation of the seismic moment tensor solution (beach ball). Seismological convention, and the default value of this parameter is lower hemisphere projection.</p><p><b>Norm</b> - Optimization norm</p><p><tt>'L2'</tt> (default) | <tt>'L1'</tt></p><p>Defines norm of the cost function as well as the algorithm that is used to perform the seismic moment tensor inversion with fociMT software. By default the seismic moment tensor is performed using <i>L2</i> norm (faster). However, if input data contains large amplitude misreadings, the user can choose <i>L1</i> norm which is less prone to larger errors.</p><p><b>Projection</b> - Projection type</p><p><tt>'schmidt'</tt> (default) | <tt>'wullf'</tt></p><p>Defines projection type for graphical representation of the seismic moment tensor inversion (beach ball). The user may use <tt>'schmidt'</tt> (equal area) or <tt>'wullf'</tt> (equal angle) projection to plot the beach ball.</p><p><b>BeachBallSize</b> - Beach ball figure size</p><p><tt>500</tt> (default) | scalar value</p><p>Defines size of graphical representation of seismic moment tensor solution exported by fociMT software in arbitrary units. For raster formats the value corresponds to pixels.</p><p><b>BeachBallFormat</b> - Beach ball figure file format</p><p><tt>'NONE'</tt> (default) | <tt>'PNG'</tt> | <tt>'SVG'</tt> | <tt>'PDF'</tt> | <tt>'PS'</tt></p><p>Defines format of graphical representation of the seismic moment tensor file (beach ball). By default, no output file is exported. Multiple file formats can be specified by appending the comma or any other delimiter, e.g. 'PNG,SVG,PS' parameter value will export beach ball in three different file formats at once.</p><p><b>IgnoreStation</b> - Ignored station(s) list</p><p><tt>{}</tt> (default) | cell array | string</p><p>Use this parameter to specify a list of stations that should be rejected from seismic moment tensor inversion. Single station can be specified as string. If multiple stations are meant to be rejected they must be provided as cell array of strings.</p><p><b>Verbose</b> - Display additional output in console window</p><p><tt>'off'</tt> (default) | <tt>'on'</tt></p><p>Turns on/off the display of additional processing information in console window.</p><p><b>VelocityModel</b> - Input 1D velocity model</p><p><tt>[]</tt> (default) | <tt>n-by-2 matrix</tt></p><p>Allows to provide a 1D velocity model as <tt>n-by-2</tt> matrix where first column corresponds to tops of the lateyers (km) and second column reflects layers' widths (km/s). When this parameter is specified it is assumed the input file is provided in 1D velocity model format.</p><p><b>MinimumPhases</b> - Minimum number of phases to calculate moment tensor solution</p><p><tt>8</tt> (default) | scalar value &gt; 0</p><p>Specifies minimum number of phases to perform the moment tensor inversion.</p><p><b>Bootstrap</b> - Perform MT inversions of resampled input phase datasets</p><p><tt>1-by-2 to 1-by-4 vector</tt></p><p>This option enables resampling of input phase dataset using variety of resampling procedures described below. For each resampled dataset the seismic moment tensor inversion is performed in the same way as for the original input dataset. The available resampling procedures can be combined altogether enabling uncertainty assessment.</p><p>The parameter <i>BootStrap</i> is followed by <tt>1-by-2</tt> to <tt>1-by-4</tt> vector <tt>V</tt> defining the number of resamplings performed and additional parameters related to different resampling procedures.</p><p>Three resampling procedures are available:</p><div><ul><li>Polarity resampling</li><li>Stations rejection resampling</li><li>Amplitude resamping</li></ul></div><p>Enabling/disabling of either of the available resampling procedures is performed by modification of the input <tt>V</tt> vector. The input <tt>V</tt> vector is in general of the form: <tt>V=[n v1 v2 v3]</tt>.</p><p><i>Polarity resampling</i></p><p>For <i>polarity resampling</i> the polarities of input phase data are randomly toggled with probability equal to <img src="doc_focimt_eq02861623039644006779.png" alt="$v1*100$"> percent. For example, if input vector for <i>Bootstrap</i> parameter is specified as <tt>V=[100 0.1]</tt> this mean that we perform moment tensor inversions on 200 randomly resampled input datasets assuming that on average 10% of stations will have reverted polarities.</p><p><i>Station rejection resampling</i></p><p>For <i>station rejection resampling</i> certain amount of stations is randomly removed from each input dataset. This is somehow similar to the <i>Jacknife test</i>, however it case of rejection resampling more than one station can be removed from the input dataset and whether or not the station is removed depends on the auxiliary parameter <tt>v2</tt>. The parameter <tt>v2</tt> determines what is the fraction of input phase data that should be removed during resampling. For example, if the input vector for <i>Bootstrap</i> parameter is specified as <tt>V=[200 0 0.05]</tt> (note 0 value that 'switches off' the <i>Polarity resampling</i> described above) we perform moment tensor inversions on 200 randomly resampled input datasets assuming that on average 5% of stations is removed from each resampled input dataset.</p><p><i>Amplitude resampling</i>%</p><p>In amplitude resampling procedure, the random noise is introduced to input amplitude data. The amount of noise is specified by 4th parameter of the input vector <tt>V</tt>, <tt>v4</tt>. In this procedure each input amplitude <img src="doc_focimt_eq07515804179761612057.png" alt="$u_i$"> is modified according to <img src="doc_focimt_eq04796982419676321962.png" alt="$u_i^*=u_i+u_i*v4*N(0,1)/3.0$">, where <img src="doc_focimt_eq09235286880098453239.png" alt="$N(0,1)$"> is a random number drawn from Gaussian distribution with mean 0 and standard deviation of 1. Therefore, to introduce the noise to input amplitude data that reaches a factor of 2 in 95% of cases and generate 300 resampled moment tensors, the input vector should stand: <tt>V=[300 0 0 1]</tt>.</p><p><i>Combining resampling</i> procedures</p><p>The resampling procedures may be combined altogether. For example assuming the parameter value for <i>Bootstrap</i> option is <tt>V=[100 0.05 0.01 1.0]</tt> we perform (in addition to regular moment tensor inversion) additional moment tensor inversions on 100 resampled input datasets, where we assume that on average 5% of input phase data has reverted polarities, 1% of stations may be rejected and the input phase data are randomly polluted with the noise reaching a factor of 2 of originally measured amplitudes.</p><p><b>CorrectStation</b> - Allows to provide a constant multiplier factor to input amplitudes</p><p><tt>cell([])</tt> (default) | {'stationname1',factor1,'stationname2',factor2,...}</p><p>Allows to provide a constant multiplication factor to input seismic moments for a specific station or stations. This can be useful when one want to correct a specific station for bad polarity or bad gain value. Also, this parameter is useful while performing the hybrid moment tensor inversion with corrected gains.</p><p><b>PlotAxes</b> - Axes plotting on the beach ball.</p><p><tt>'off'</tt> (default) | <tt>'on'</tt></p><p>Toggle on/off plotting cardinal P/T axes on graphical representation of the seismic moment tensor.</p><p><b>PlotCross</b> - Center cross plotting on the beach ball.</p><p><tt>'off'</tt> (default) | <tt>'on'</tt></p><p>Toggle on/off plotting of the center cross on graphical representation of the seismic moment tensor.</p><p><b>PlotDC</b> - Nodal lines plotting on the beach ball.</p><p><tt>'off'</tt> (default) | <tt>'on'</tt></p><p>Toggle on/off plotting of the nodal lines on graphical representation of the seismic moment tensor.</p><p><b>PlotStations</b> - Stations plotting on the beach ball.</p><p><tt>'off'</tt> (default) | <tt>'on'</tt></p><p>Toggle on/off plotting stations on graphical representation of the seismic moment tensor.</p><p><b>ProjectDir</b> - Specify output project directory</p><p><tt>''</tt> (default) | 'directoryname' (valid directory name)</p><p>Use <b>ProjectDir</b> to specify output directory for text files, graphical representations of moment tensor inversion and other files. Also, the input data table (if exists) is copied to this directory after the inversion.</p><p><b>Solutions</b> - Specify which moment tensors to calculate</p><p><tt>'FTD'</tt> (default) | <tt>string combination of 'F', 'T' or 'D' characters</tt></p><p>Use <b>Solutions</b> to specify which type of seismic moment tensor to calculate. By default all three types of moment tensors are calculated: uncostrained full (<tt>'F'</tt>), deviatoric (<tt>'T'</tt>) and double-couple (<tt>'D'</tt>) constrained moment tensor. However, it is possible to limit the moment tensor inversion to specific type or types of moment tensors calculated resulting in improved performance of the algorithm and limiting execution time. For example, to calculate only full moment tensors, the user may specify:</p><pre class="language-matlab">Solution = focimt(<span class="string">'example.txt'</span>,<span class="string">'Solutions'</span>,<span class="string">'F'</span>);
</pre><h2>Examples<a name="71"></a></h2><p><b>Example 1</b></p><p>Use sample input fociMT file <tt>example1.txt</tt> and perform the seismic moment tensor inversion using default parameters. Then we gather the output data and input data in two cell array structures:</p><pre class="codeinput">[Output, Input] = focimt(<span class="string">'./examples/example1.txt'</span>);
Input
Output
</pre><pre class="codeoutput">
Input = 

    [1x1 struct]


Output = 

    [1x1 struct]

</pre><p>As the input data contains single seismic event, both <tt>Output</tt> and <tt>Input</tt> are cell arrays with only one element corresponding to the processed seismic event. To see the particular seismic moment tensor solution from the particular seismic events, use cell indexing access:</p><pre class="codeinput">Output{1}
</pre><pre class="codeoutput">
ans = 

          event_id: 'example1_ev01'
          n_trials: 1
    calculation_dt: 7.3628e+05
              full: [1x1 struct]
        deviatoric: [1x1 struct]
                dc: [1x1 struct]

</pre><p>The seismic moment tensor solution for a particular event contains in fact three types of seismic moment tensors: the full moment tensor, the deviatoric (trace-null) moment tensor and the double-couple moment tensor. They can be accessible by inspecting <tt>full</tt>, <tt>clvd</tt> and <tt>dc</tt> structures, of the cell array element. For example, to see the full moment tensor inversion result, you have to access:</p><pre class="codeinput">Output{1}.full
</pre><pre class="codeoutput">
ans = 

          Type: {'N'}
    STATION_ID: 0
           ISO: 5.6167
          CLVD: 17.572
            DC: 76.811
            M0: 1.3183e+12
            MT: 1.3322e+12
      M0ERRMAX: 5.7314e+10
            MW: 2.05
             P: [350.52 72.611]
             T: [215.42 12.508]
             B: [122.74 11.885]
            F1: [115.35 58.557 -103.97]
            F2: [320.84 34.113 -68.456]
         Fault: {'NF'}
           MXX: [1x6 double]
           CXX: [3.2849e+21 1.7096e+21 2.1977e+21 5e+20 4.7968e+20 9.8276e+19]
      RMSERROR: 0.43078
       Station: {1x21 cell}
     UMEASURED: [1x21 double]
           UTH: [1x21 double]

</pre><p>The input data originally available inside input file <tt>example1.txt</tt> are interpreted internally in <tt>focimt.m</tt> function and are returned in the second output parameter of the routine:</p><pre class="codeinput">Input{1}
</pre><pre class="codeoutput">
ans = 

      event_id: 'example1_ev01'
      n_phases: 21
        format: 'raw'
    matrixmode: 1
       Station: {21x1 cell}
     Component: {21x1 cell}
         Phase: {21x1 cell}
         OMEGA: [21x1 double]
       AZIMUTH: [21x1 double]
           AOI: [21x1 double]
       TAKEOFF: [21x1 double]
             V: [21x1 double]
             R: [21x1 double]
       DENSITY: [21x1 double]

</pre><p><b>Example 2</b></p><p>We can create a graphical representation of the seismic moment tensor in a form of a beach ball plot. In this case, we have to execute <tt><a href="doc_focimt.html">focimt.m</a></tt> routine with additional properties. For example, the following code will perform the moment tensor inversion and three pictures in PNG format will be generated:</p><pre class="codeinput">focimt(<span class="string">'./examples/example1.txt'</span>,<span class="string">'BeachBallFormat'</span>,<span class="string">'PNG'</span>);
</pre><p>The code above produce three pictures, one for each type of moment tensor solution:</p><p><img vspace="5" hspace="5" src="example1_ev01-full.png" alt=""> </p><p><img vspace="5" hspace="5" src="example1_ev01-deviatoric.png" alt=""> </p><p><img vspace="5" hspace="5" src="example1_ev01-dc.png" alt=""> </p><p>The available formats are PNG, PDF, PS and SVG. The graphical representation of the moment tensor solution can be customized using different properties: Use <i>BeachBallSize</i> property to generate the picture of the certain size. The <i>Projection</i> parameter controls the type of stereonet projection (either equal area or equal angle projections is available). Finally, the <i>Hemisphere</i> parameters allows to choose between lower (default) or upper hemisphere projection. a beach. You can combine the properties to obtain the desired figure shape. For example:</p><pre class="codeinput">focimt(<span class="string">'./examples/example1.txt'</span>,<span class="string">'BeachBallFormat'</span>,<span class="string">'PDF'</span>,<span class="string">'Projection'</span>,<span class="string">'wullf'</span>,<span class="string">'Hemisphere'</span>,<span class="string">'upper'</span>);
</pre><p>will produce the upper hemisphere equal-angle stereonet projection of the seismic moment tensor solution in PDF format.</p><p><b>Example 3</b></p><p>In this example we perform the seismic moment tensor inversion of two events using Jacknife test to check the stability of both inversions. We export the solution to SVG files and slightly modify the output figure size. Note that the SVG vector format is a convenient way to present your results on web pages, as nowadays it is supported by all web browsers:</p><pre class="codeinput">focimt(<span class="string">'./examples/example2_raw.txt'</span>,<span class="string">'BeachBallFormat'</span>,<span class="string">'SVG'</span>,<span class="string">'BeachBallSize'</span>,250,<span class="string">'Jacknife'</span>,<span class="string">'on'</span>);
</pre><p>The resulting graphical representation of the seismic moment tensor inversion solutions for the first seismic event look as follows:</p><p><img vspace="5" hspace="5" src="344_014_+165-full.svg" alt=""> </p><p><img vspace="5" hspace="5" src="344_014_+165-deviatoric.svg" alt=""> </p><p><img vspace="5" hspace="5" src="344_014_+165-dc.svg" alt=""> </p><p>The first seismic moment tensor solution corresponds to the uncostrained (full) moment tensor. The second solution presents the seismic moment tensor that was constrained to not to have the volumetric changes (i.e. the trace of the tensor was forced to be 0 during inversion). This solution correspond to the seismic moment tensor containing only CLVD (compensated linear vector dipole) and DC (double-couple) components. Finally, the last figure presents the DC constrained moment tensor (the determinant and trace of the tensor is kept to be null during inversion).</p><p>The resulting focal mechanisms contains additional nodal lines. Each line corresponds to a different moment tensor solution calculated using input data will all but one station. Therefore, in addition to the original seismic moment tensor solution, there is <tt>N</tt> more nodal lines where <tt>N</tt> is the number of stations (or phases) picked.</p><p>The Jacknife test is useful to determine whether removal of a particular station strongly affects the seismic moment tensor inversion results. In this case, the particular Jacknife solution will likely differ significantly from the remaining ones. This can be a useful test to detect bad stations.</p><p><b>Example 4</b></p><p>We perform the moment tensor inversion using the built-in 1D velocity model ray-tracer. When 1D velocity model and 1D ray-tracer is used, the input data must be provided using different file format. We firstly define the velocity model:</p><pre class="codeinput">VMODEL = [0.00 3.00 8.00 20.00 22.00; 4.10 5.47 5.75 6.02 7.90]';
</pre><p>The velocity model matrix is composed of two colums. The elements in the first column correspond to layer tops (in km) and the elements from the second column to P-wave velocity (km/s). Once we have the velocity model, we can perform the moment tensor inversion:</p><pre class="codeinput">focimt(<span class="string">'./examples/example2_1d.txt'</span>,<span class="string">'BeachBallFormat'</span>,<span class="string">'PNG'</span>,<span class="string">'BeachBallSize'</span>,250,<span class="string">'VelocityModel'</span>,VMODEL);
</pre><p>As the input phase data were the same as in example 3 (only the input format has changed), the resulting moment tensor solutions are identical:</p><p><img vspace="5" hspace="5" src="344_014_+165-full.png" alt=""> </p><p><img vspace="5" hspace="5" src="344_014_+165-deviatoric.png" alt=""> </p><p><img vspace="5" hspace="5" src="344_014_+165-dc.png" alt=""> </p><h2>See also<a name="92"></a></h2><p><tt><a href="doc_hybridmt.html">hybridmt</a></tt> <tt><a href="doc_readraw.html">readraw</a></tt> | <tt><a href="doc_readvel1d.html">readvel1d</a></tt> | <tt><a href="doc_genmt_raw.html">genmt_raw</a></tt> | <tt><a href="doc_genmt_vel1d.html">genmt_vel1d</a></tt></p><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2014b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% focimt
% Perform seismic moment tensor inversion in time domain.
%% Syntax
%   focimt(Input)
%   focimt(Input,'PropertyName',PropertyValue, ...)
%   [Solution, Input] = focimt(...)
%
%% Description
% Use |focimt| to perform the seismic moment tensor inversion using fociMT
% application via MATLAB interface. The function wraps the input and output of
% data for fociMT executable and provide a convenient interface between
% MATLAB and fociMT application.
%%
% |focimt(Input)| reads input data and performs moment tensor inversion using
% fociMT software and default processing parameters. The input array can 
% be either a path to the formatted ASCII input file or Input cell array.
%%
% |focimt(Input,'PropertyName',PropertyValue, ...)| allows to specify 
% additional parameters in a form of PropertyName-PropertyValue pairs.
%%
% |[Solution, Input] = focimt(...)| returns final moment tensor solutions
% in a form of cell array |Solution| as well as input cell array |Input|.
%% Additional information
% For an up-to-date information on software package, see the following website: 
% <http://www.induced.pl/focimt>.
%% Parameters
% *Jacknife* - Single station rejection test 
%%
% |'off'| (default) | |'on'|
%%
% Performs station rejection test. Firstly, the seismic moment tensor inversion
% is performed using all available stations. Then, the inversion is performed
% _n_ times, where _n_ is the number of stations, and each time different
% station is removed before inversion is performed. See _Examples_ section for
% details.
%%
% *Hemisphere* - Hemisphere projection 
%%
% |'lower'| (default) | |'upper'|
%%
% Allows to specify whether the obtained fault plane solution is projected
% onto |'lower'| or |'upper'| part of the hemisphere in graphical representation
% of the seismic moment tensor solution (beach ball). Seismological convention, 
% and the default value of this parameter is lower hemisphere projection.
%%
% *Norm* - Optimization norm 
%%
% |'L2'| (default) | |'L1'|
%%
% Defines norm of the cost function as well as the algorithm that is used
% to perform the seismic moment tensor inversion with fociMT software. By
% default the seismic moment tensor is performed using _L2_ norm (faster).
% However, if input data contains large amplitude misreadings, the user can
% choose _L1_ norm which is less prone to larger errors.
%%
% *Projection* - Projection type
%%
% |'schmidt'| (default) | |'wullf'|
%%
% Defines projection type for graphical representation of the seismic
% moment tensor inversion (beach ball). The user may use |'schmidt'| (equal 
% area) or |'wullf'| (equal angle) projection to plot the beach ball. 
%%
% *BeachBallSize* - Beach ball figure size 
%%
% |500| (default) | scalar value
%%
% Defines size of graphical representation of seismic moment tensor
% solution exported by fociMT software in arbitrary units. For raster
% formats the value corresponds to pixels.
%%
% *BeachBallFormat* - Beach ball figure file format 
%%
% |'NONE'| (default) | |'PNG'| | |'SVG'| | |'PDF'| | |'PS'|
%%
% Defines format of graphical representation of the seismic moment tensor
% file (beach ball). By default, no output file is exported. Multiple file
% formats can be specified by appending the comma or any other delimiter,
% e.g. 'PNG,SVG,PS' parameter value will export beach ball in three
% different file formats at once.
%%
% *IgnoreStation* - Ignored station(s) list 
%%
% |{}| (default) | cell array | string
%%
% Use this parameter to specify a list of stations that should be rejected
% from seismic moment tensor inversion. Single station can be specified as
% string. If multiple stations are meant to be rejected they must be
% provided as cell array of strings.
%%
% *Verbose* - Display additional output in console window 
%%
% |'off'| (default) | |'on'|
%%
% Turns on/off the display of additional processing information in console
% window. 
%%
% *VelocityModel* - Input 1D velocity model 
%%
% |[]| (default) | |n-by-2 matrix|
%%
% Allows to provide a 1D velocity model as |n-by-2| matrix where first
% column corresponds to tops of the lateyers (km) and second column reflects
% layers' widths (km/s). When this parameter is specified it is assumed the
% input file is provided in 1D velocity model format.
%
%%
% *MinimumPhases* - Minimum number of phases to calculate moment tensor solution 
%%
% |8| (default) | scalar value > 0
%%
% Specifies minimum number of phases to perform the moment tensor
% inversion.
%
%% 
% *Bootstrap* - Perform MT inversions of resampled input phase datasets
%%
% |1-by-2 to 1-by-4 vector| 
%%
% This option enables resampling of input phase dataset using variety of
% resampling procedures described below. For each resampled dataset the 
% seismic moment tensor
% inversion is performed in the same way as for the original input dataset.
% The available resampling procedures can be combined altogether enabling uncertainty 
% assessment.
%%%
% The parameter _BootStrap_ is followed by |1-by-2| to |1-by-4| vector |V| defining the
% number of resamplings performed and additional parameters
% related to different resampling procedures.
%%%
% Three resampling procedures are available:
%
% * Polarity resampling
% * Stations rejection resampling
% * Amplitude resamping
%
% Enabling/disabling of either of the available resampling procedures is performed
% by modification of the input |V| vector. The input |V| vector is in general of the form: |V=[n v1
% v2 v3]|.
%%%
% _Polarity resampling_
%%%
% For _polarity resampling_ the polarities of input phase data are randomly
% toggled with probability equal to $v1*100$ percent.
% For example, if input vector for _Bootstrap_ parameter is specified 
% as |V=[100 0.1]| this mean that we perform moment tensor inversions 
% on 200 randomly resampled input datasets assuming that on average 10% of stations 
% will have reverted polarities.
%%%
% _Station rejection resampling_
%%%
% For _station rejection resampling_ certain amount of stations is randomly 
% removed from each input dataset. This is somehow similar to the _Jacknife
% test_, however it case of rejection resampling more than one station can
% be removed from the input dataset and whether or not the station is
% removed depends on the auxiliary parameter |v2|. The parameter |v2|
% determines what is the fraction of input phase data that should be
% removed during resampling. For example, if the input vector 
% for _Bootstrap_ parameter is specified as |V=[200 0 0.05]| (note 0 value 
% that 'switches off' the _Polarity resampling_ described above) we
% perform moment tensor inversions on 200 randomly resampled input datasets
% assuming that on average 5% of stations is removed from each resampled
% input dataset.
%%%
% _Amplitude resampling_%
%%%
% In amplitude resampling procedure, the random noise is introduced to
% input amplitude data. The amount of noise is specified by 4th parameter
% of the input vector |V|, |v4|. In this procedure each input amplitude $u_i$ 
% is modified according to $u_i^*=u_i+u_i*v4*N(0,1)/3.0$, where $N(0,1)$ is a
% random number drawn from Gaussian distribution with mean 0 and standard
% deviation of 1. Therefore, to introduce the noise to input amplitude data
% that reaches a factor of 2 in 95% of cases and generate 300 resampled
% moment tensors, the input vector should stand: |V=[300 0 0 1]|.
%%%
% _Combining resampling_ procedures
%%%
% The resampling procedures may be combined altogether. For example
% assuming the parameter value for _Bootstrap_ option is |V=[100 0.05 0.01
% 1.0]| we perform (in addition to regular moment tensor inversion)
% additional moment tensor inversions on 100 resampled input datasets,
% where we assume that on average 5% of input phase data has reverted
% polarities, 1% of stations may be rejected and the input phase data are
% randomly polluted with the noise reaching a factor of 2 of originally
% measured amplitudes.
%% 
% *CorrectStation* - Allows to provide a constant multiplier factor to input amplitudes
%%
% |cell([])| (default) | {'stationname1',factor1,'stationname2',factor2,...}
%%
% Allows to provide a constant multiplication factor to input seismic moments
% for a specific station or stations. This can be useful when one want to
% correct a specific station for bad polarity or bad gain value. Also, this
% parameter is useful while performing the hybrid moment tensor inversion with
% corrected gains.
%
%% 
% *PlotAxes* - Axes plotting on the beach ball.
%%
% |'off'| (default) | |'on'|
%%
% Toggle on/off plotting cardinal P/T axes on graphical representation of the seismic 
% moment tensor.
%% 
% *PlotCross* - Center cross plotting on the beach ball.
%%
% |'off'| (default) | |'on'|
%%
% Toggle on/off plotting of the center cross on graphical representation of the seismic 
% moment tensor.
%% 
% *PlotDC* - Nodal lines plotting on the beach ball.
%%
% |'off'| (default) | |'on'|
%%
% Toggle on/off plotting of the nodal lines on graphical representation of the seismic 
% moment tensor.
%% 
% *PlotStations* - Stations plotting on the beach ball.
%%
% |'off'| (default) | |'on'|
%%
% Toggle on/off plotting stations on graphical representation of the seismic 
% moment tensor.

%%
% *ProjectDir* - Specify output project directory
%%
% |''| (default) | 'directoryname' (valid directory name)
%% 
% Use *ProjectDir* to specify output directory for text files, graphical
% representations of moment tensor inversion and other files. Also, the input
% data table (if exists) is copied to this directory after the inversion.

%%
% *Solutions* - Specify which moment tensors to calculate
%%
% |'FTD'| (default) | |string combination of 'F', 'T' or 'D' characters|
%% 
% Use *Solutions* to specify which type of seismic moment tensor to
% calculate. By default all three types of moment tensors are calculated:
% uncostrained full (|'F'|), deviatoric (|'T'|) and double-couple (|'D'|)
% constrained moment tensor. However, it is possible to limit the moment tensor
% inversion to specific type or types of moment tensors calculated
% resulting in improved performance of the algorithm and limiting execution
% time. For example, to calculate only full moment tensors, the user may
% specify:
%
%   Solution = focimt('example.txt','Solutions','F');

%% Examples
%%
% *Example 1*
%%
% Use sample input fociMT file |example1.txt| and perform the seismic 
% moment tensor inversion using default parameters. Then we gather the output data and 
% input data in two cell array structures:
[Output, Input] = focimt('./examples/example1.txt');
Input
Output
%% 
% As the input data contains single seismic event, both |Output| and
% |Input| are cell arrays with only one element corresponding to the 
% processed seismic event. To see the particular seismic moment tensor solution from 
% the particular seismic events, use cell indexing access:
Output{1}
%% 
% The seismic moment tensor solution for a particular event contains in
% fact three types of seismic moment tensors: the full moment tensor, the
% deviatoric (trace-null) moment tensor and the double-couple moment tensor.
% They can be accessible by inspecting |full|, |clvd| and |dc| structures,
% of the cell array element. For example, to see the full moment tensor
% inversion result, you have to access:
Output{1}.full
%%
% The input data originally available inside input file |example1.txt| are interpreted internally in 
% |focimt.m| function and are returned in the second output parameter of the routine:
Input{1}
%% 
% *Example 2*
%%
% We can create a graphical representation of the seismic moment tensor in
% a form of a beach ball plot. In this case, we have to execute |<doc_focimt.html focimt.m>|
% routine with additional properties. For example, the following code will
% perform the moment tensor inversion and three pictures in PNG format will
% be generated:
focimt('./examples/example1.txt','BeachBallFormat','PNG');
%% 
% The code above produce three pictures, one for each type of moment tensor solution:
%
% <<example1_ev01-full.png>>
%
% <<example1_ev01-deviatoric.png>>
%
% <<example1_ev01-dc.png>>
%
%%
% The available formats are PNG, PDF, PS and SVG. The graphical
% representation of the moment tensor solution can be customized using
% different properties: Use _BeachBallSize_ property to generate the picture 
% of the certain size. The _Projection_ parameter controls
% the type of stereonet projection (either equal area or equal angle
% projections is available). Finally, the _Hemisphere_ parameters allows to
% choose between lower (default) or upper hemisphere projection.
% a beach. You can combine the properties to obtain the desired figure shape.
% For example:
focimt('./examples/example1.txt','BeachBallFormat','PDF','Projection','wullf','Hemisphere','upper');
%% 
% will produce the upper hemisphere equal-angle stereonet projection of the
% seismic moment tensor solution in PDF format. 
%%
% *Example 3*
%%
% In this example we perform the seismic moment tensor inversion of two events 
% using Jacknife test to check the stability of both inversions. We export 
% the solution to SVG files and slightly modify the output figure size. Note that 
% the SVG vector format is a convenient way to present your results on web pages, as 
% nowadays it is supported by all web browsers:
focimt('./examples/example2_raw.txt','BeachBallFormat','SVG','BeachBallSize',250,'Jacknife','on');
%%
% The resulting graphical representation of the seismic moment tensor inversion solutions 
% for the first seismic event look as follows:
%
% <<344_014_+165-full.svg>>
%
% <<344_014_+165-deviatoric.svg>>
%
% <<344_014_+165-dc.svg>>
%
%%
% The first seismic moment tensor solution corresponds to the uncostrained (full) 
% moment tensor. The second solution presents the seismic moment tensor that was constrained
% to not to have the volumetric changes (i.e. the trace of the tensor was
% forced to be 0 during inversion). This solution correspond to the seismic moment
% tensor containing only CLVD (compensated linear vector dipole) and DC (double-couple) components. 
% Finally, the last figure presents the DC constrained moment tensor (the determinant and trace of the 
% tensor is kept to be null during inversion).
%%
% The resulting focal mechanisms contains additional nodal lines. Each line
% corresponds to a different moment tensor solution calculated using input data 
% will all but one station. Therefore, in addition to the original seismic moment
% tensor solution, there is |N| more nodal lines where |N| is the number of
% stations (or phases) picked.
%%
% The Jacknife test is useful to determine whether removal of a particular station
% strongly affects the seismic moment tensor inversion results. In this case,
% the particular Jacknife solution will likely differ significantly from the
% remaining ones. This can be a useful test to detect bad stations.
%%
% *Example 4*
%%
% We perform the moment tensor inversion using the built-in 1D velocity model ray-tracer. When
% 1D velocity model and 1D ray-tracer is used, the input data must be provided using different file 
% format. We firstly define the velocity model:
VMODEL = [0.00 3.00 8.00 20.00 22.00; 4.10 5.47 5.75 6.02 7.90]';
%%
% The velocity model matrix is composed of two colums. The elements in the 
% first column correspond to layer tops (in km) and the elements from the second
% column to P-wave velocity (km/s). Once we have the velocity model, we can
% perform the moment tensor inversion:
focimt('./examples/example2_1d.txt','BeachBallFormat','PNG','BeachBallSize',250,'VelocityModel',VMODEL);
%%
% As the input phase data were the same as in example 3 (only the input
% format has changed), the resulting moment tensor solutions are 
% identical:
%
% <<344_014_+165-full.png>>
%
% <<344_014_+165-deviatoric.png>>
%
% <<344_014_+165-dc.png>>
%
% 
%% See also
% |<doc_hybridmt.html hybridmt>|
% |<doc_readraw.html readraw>| | 
% |<doc_readvel1d.html readvel1d>| |  
% |<doc_genmt_raw.html genmt_raw>| | 
% |<doc_genmt_vel1d.html genmt_vel1d>|





##### SOURCE END #####
--></body></html>